import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,e as t,o as n}from"./app-BOVwgLKd.js";const e={};function h(l,s){return n(),a("div",null,s[0]||(s[0]=[t(`<h1 id="sshd" tabindex="-1"><a class="header-anchor" href="#sshd"><span>sshd</span></a></h1><h2 id="服务端启动命令-sshd" tabindex="-1"><a class="header-anchor" href="#服务端启动命令-sshd"><span>服务端启动命令 sshd</span></a></h2><p>命令行远程服务</p><h3 id="安装与启用" tabindex="-1"><a class="header-anchor" href="#安装与启用"><span><a href="#%E5%AE%89%E8%A3%85%E4%B8%8E%E5%90%AF%E7%94%A8"></a>安装与启用</span></a></h3><ul><li>apt 包名：ssh</li><li>systemctl 服务名称：sshd</li></ul><h2 id="配置" tabindex="-1"><a class="header-anchor" href="#配置"><span><a href="#%E9%85%8D%E7%BD%AE"></a>配置</span></a></h2><ul><li>主配置文件：/etc/ssh/sshd_config</li></ul><h3 id="配置文件常用参数" tabindex="-1"><a class="header-anchor" href="#配置文件常用参数"><span>配置文件常用参数</span></a></h3><table><thead><tr><th>参数</th><th>作用</th></tr></thead><tbody><tr><td>Port 22</td><td>默认的sshd服务端口</td></tr><tr><td>ListenAddress 0.0.0.0</td><td>设定sshd服务器监听的IP地址</td></tr><tr><td>Protocol 2</td><td>SSH协议的版本号</td></tr><tr><td>HostKey /tc/ssh/ssh_host_key</td><td>SSH协议版本为1时，DES私钥存放的位置</td></tr><tr><td>HostKey /etc/ssh/ssh_host_rsa_key</td><td>SSH协议版本为2时，RSA私钥存放的位置</td></tr><tr><td>HostKey /etc/ssh/ssh_host_dsa_key</td><td>SSH协议版本为2时，DSA私钥存放的位置</td></tr><tr><td>PermitRootLogin yes</td><td>设定是否允许root管理员直接登录</td></tr><tr><td>StrictModes yes</td><td>当远程用户的私钥改变时直接拒绝连接</td></tr><tr><td>MaxAuthTries 6</td><td>最大密码尝试次数</td></tr><tr><td>MaxSessions 10</td><td>最大终端数</td></tr><tr><td>PasswordAuthentication yes</td><td>是否允许密码验证</td></tr><tr><td>PermitEmptyPasswords no</td><td>是否允许空密码登录（很不安全）</td></tr></tbody></table><h2 id="客户端连接命令-ssh" tabindex="-1"><a class="header-anchor" href="#客户端连接命令-ssh"><span>客户端连接命令 ssh</span></a></h2><h2 id="远程登陆" tabindex="-1"><a class="header-anchor" href="#远程登陆"><span>远程登陆</span></a></h2><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># ssh 登陆</span></span>
<span class="line"><span>ssh USER@IP</span></span>
<span class="line"><span># 生成密钥对</span></span>
<span class="line"><span>ssh-keygen</span></span>
<span class="line"><span># 上传公钥 </span></span>
<span class="line"><span>ssh-cpoy-id IP</span></span>
<span class="line"><span># 删除本地信任主机</span></span>
<span class="line"><span>ssh-keygen -R 192.168.3.126</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="参数" tabindex="-1"><a class="header-anchor" href="#参数"><span>参数</span></a></h3><p>-o： 以 key=value 形式设置</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 跳过已知主机对端主机验证</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ssh</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> StrictHostKeyChecking=no</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root@127.0.0.1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ls</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="sshconfig" tabindex="-1"><a class="header-anchor" href="#sshconfig"><span>sshconfig</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tee</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ~/.ssh/config</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Host *</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	ServerAliveInterval 60</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="远程拷贝-scp" tabindex="-1"><a class="header-anchor" href="#远程拷贝-scp"><span>远程拷贝 scp</span></a></h2><table><thead><tr><th>参数</th><th>作用</th></tr></thead><tbody><tr><td>-v</td><td>显示详细的连接进度</td></tr><tr><td>-P</td><td>指定远程主机的sshd端口号</td></tr><tr><td>-r</td><td>用于传送文件夹</td></tr><tr><td>-6</td><td>使用IPv6协议</td></tr></tbody></table><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 本地当前目录 a.txt 拷贝到服务上的家目录下</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">scp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a.txt</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $USER</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">@IP:/home/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$USER</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 服务器上家目录下的 b.txt 拷贝到本地当前目录下</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">scp</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $USER</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">@IP:/home/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$USER</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/b.txt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="基于ssh协议的rsync" tabindex="-1"><a class="header-anchor" href="#基于ssh协议的rsync"><span><a href="#%E5%9F%BA%E4%BA%8Essh%E5%8D%8F%E8%AE%AE%E7%9A%84rsync"></a>基于ssh协议的rsync</span></a></h6><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 增量同步</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rsync</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --rsh=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;ssh -p 22&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -auzvP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">use</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">r&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">@</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">hos</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">pat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">h&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 完全同步</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rsync</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --rsh=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;ssh -p 22&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -auzvP</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --delete</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">use</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">r&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">@</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">hos</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">pat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">h&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ssh-自动断开连接" tabindex="-1"><a class="header-anchor" href="#ssh-自动断开连接"><span><a href="#ssh-%E8%87%AA%E5%8A%A8%E6%96%AD%E5%BC%80%E8%BF%9E%E6%8E%A5"></a>ssh 自动断开连接</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sshd_config</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sshd_config.bak</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ClientAliveInterval 活跃间隔，单位：秒</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;s/#ClientAliveInterval 0/ClientAliveInterval 60/g&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sshd_config</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ClientAliveCountMax 计数</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;s/#ClientAliveCountMax 3/ClientAliveCountMax 3/g&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sshd_config</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ClientAlive</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sshd_config</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">diff</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sshd_config</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sshd_config.bak</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reload</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sshd</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="暴力破解" tabindex="-1"><a class="header-anchor" href="#暴力破解"><span><a href="#%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"></a>暴力破解</span></a></h2><ul><li>Medusa</li><li>Hydra</li></ul><p>防暴力破解</p><ul><li>fail2ban</li></ul>`,28)]))}const p=i(e,[["render",h]]),k=JSON.parse('{"path":"/notes/linux/%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/sshd.html","title":"sshd","lang":"zh-CN","frontmatter":{"date":"2022-01-09T00:00:00.000Z","category":"应用服务","tag":["Linux","系统基础服务"],"description":"sshd 服务端启动命令 sshd 命令行远程服务 安装与启用 apt 包名：ssh systemctl 服务名称：sshd 配置 主配置文件：/etc/ssh/sshd_config 配置文件常用参数 客户端连接命令 ssh 远程登陆 参数 -o： 以 key=value 形式设置 sshconfig 远程拷贝 scp 基于ssh协议的rsync s...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"sshd\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-01-09T00:00:00.000Z\\",\\"dateModified\\":\\"2025-01-02T07:54:44.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://xiangcheng.site/notes/linux/%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/sshd.html"}],["meta",{"property":"og:site_name","content":"大橙的运维宝典"}],["meta",{"property":"og:title","content":"sshd"}],["meta",{"property":"og:description","content":"sshd 服务端启动命令 sshd 命令行远程服务 安装与启用 apt 包名：ssh systemctl 服务名称：sshd 配置 主配置文件：/etc/ssh/sshd_config 配置文件常用参数 客户端连接命令 ssh 远程登陆 参数 -o： 以 key=value 形式设置 sshconfig 远程拷贝 scp 基于ssh协议的rsync s..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-01-02T07:54:44.000Z"}],["meta",{"property":"article:tag","content":"系统基础服务"}],["meta",{"property":"article:tag","content":"Linux"}],["meta",{"property":"article:published_time","content":"2022-01-09T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-01-02T07:54:44.000Z"}]]},"git":{"createdTime":1732214708000,"updatedTime":1735804484000,"contributors":[{"name":"daCheng","username":"daCheng","email":"xiangxiaoc@outlook.com","commits":2,"url":"https://github.com/daCheng"}]},"readingTime":{"minutes":1.78,"words":534},"filePathRelative":"notes/linux/应用服务/sshd.md","excerpt":"\\n<h2>服务端启动命令 sshd</h2>\\n<p>命令行远程服务</p>\\n<h3><a class=\\"header-anchor\\" href=\\"#安装与启用\\"><span></span></a><a href=\\"#%E5%AE%89%E8%A3%85%E4%B8%8E%E5%90%AF%E7%94%A8\\"></a>安装与启用</h3>\\n<ul>\\n<li>apt 包名：ssh</li>\\n<li>systemctl 服务名称：sshd</li>\\n</ul>\\n<h2><a class=\\"header-anchor\\" href=\\"#配置\\"><span></span></a><a href=\\"#%E9%85%8D%E7%BD%AE\\"></a>配置</h2>","autoDesc":true}');export{p as comp,k as data};
