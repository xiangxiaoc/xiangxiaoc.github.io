import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,d as i,o as e}from"./app-D1tNWjRw.js";const l={};function t(d,s){return e(),n("div",null,s[0]||(s[0]=[i(`<h1 id="samba-微软的网络文件系统" tabindex="-1"><a class="header-anchor" href="#samba-微软的网络文件系统"><span>samba - 微软的网络文件系统</span></a></h1><p>微软公司和英特尔公司共同制定了SMB（Server Messages Block，服务器消息块）协议，Samba服务程序现在已经成为在Linux系统与Windows系统之间共享文件的最佳选择。</p><h3 id="安装与启用" tabindex="-1"><a class="header-anchor" href="#安装与启用"><span><a href="#%E5%AE%89%E8%A3%85%E4%B8%8E%E5%90%AF%E7%94%A8"></a>安装与启用</span></a></h3><ul><li>yum、apt 包名：samba</li><li>RHEL 系 systemctl 服务名：smb</li><li>RHEL 系 客户端包名：samba-client cifs-utils</li><li>Debain 系 systemctl 服务名：smbd</li><li>apt 客户端包名：smbclient cifs-utils</li></ul><h2 id="rhel-系配置" tabindex="-1"><a class="header-anchor" href="#rhel-系配置"><span><a href="#rhel-%E7%B3%BB%E9%85%8D%E7%BD%AE"></a>RHEL 系配置</span></a></h2><h5 id="防火墙" tabindex="-1"><a class="header-anchor" href="#防火墙"><span><a href="#%E9%98%B2%E7%81%AB%E5%A2%99"></a>防火墙</span></a></h5><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>firewall-cmd --permanent --add-service=samba</span></span>
<span class="line"><span>firewall-cmd --reload</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>主配置文件：/etc/samba/smb.conf</li></ul><p>配置文件讲解</p><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>[global]		#全局参数。</span></span>
<span class="line"><span>        workgroup = MYGROUP	#工作组名称</span></span>
<span class="line"><span>        server string = Samba Server Version %v	    #服务器介绍信息，参数%v为显示SMB版本号</span></span>
<span class="line"><span>        log file = /var/log/samba/log.%m	#定义日志文件的存放位置与名称，参数%m为来访的主机名</span></span>
<span class="line"><span>        max log size = 50	#定义日志文件的最大容量为50KB</span></span>
<span class="line"><span>        security = user	#安全验证的方式，总共有4种</span></span>
<span class="line"><span>        #share：来访主机无需验证口令；比较方便，但安全性很差</span></span>
<span class="line"><span>        #user：需验证来访主机提供的口令后才可以访问；提升了安全性</span></span>
<span class="line"><span>        #server：使用独立的远程主机验证来访主机提供的口令（集中管理账户）</span></span>
<span class="line"><span>        #domain：使用域控制器进行身份验证</span></span>
<span class="line"><span>        passdb backend = tdbsam	#定义用户后台的类型，共有3种</span></span>
<span class="line"><span>        #smbpasswd：使用smbpasswd命令为系统用户设置Samba服务程序的密码</span></span>
<span class="line"><span>        #tdbsam：创建数据库文件并使用pdbedit命令建立Samba服务程序的用户</span></span>
<span class="line"><span>        #ldapsam：基于LDAP服务进行账户验证</span></span>
<span class="line"><span>        load printers = yes	#设置在Samba服务启动时是否共享打印机设备</span></span>
<span class="line"><span>        cups options = raw	#打印机的选项</span></span>
<span class="line"><span>[homes]		#共享参数</span></span>
<span class="line"><span>        comment = Home Directories	#描述信息</span></span>
<span class="line"><span>        browseable = no	#指定共享信息是否在“网上邻居”中可见</span></span>
<span class="line"><span>        writable = yes	#定义是否可以执行写入操作，与“read only”相反</span></span>
<span class="line"><span>[printers]		#打印机共享参数</span></span>
<span class="line"><span>        comment = All Printers	</span></span>
<span class="line"><span>        path = /var/spool/samba	#共享文件的实际路径(重要)。</span></span>
<span class="line"><span>        browseable = no	</span></span>
<span class="line"><span>        guest ok = no	#是否所有人可见，等同于&quot;public&quot;参数。</span></span>
<span class="line"><span>        writable = no	</span></span>
<span class="line"><span>        printable = yes</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="快速配置" tabindex="-1"><a class="header-anchor" href="#快速配置"><span><a href="#%E5%BF%AB%E9%80%9F%E9%85%8D%E7%BD%AE"></a>快速配置</span></a></h3><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># 备份配置文件</span></span>
<span class="line"><span>mv /etc/samba/smb.conf{,.bak}</span></span>
<span class="line"><span># 过滤无效行</span></span>
<span class="line"><span>cat /etc/samba/smb.conf.bak | grep -v &quot;#&quot; | grep -v &quot;;&quot; | grep -v &quot;^$&quot; &gt; /etc/samba/smb.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>vim /etc/samba/smb.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># 共享名称</span></span>
<span class="line"><span>[samba_share]	</span></span>
<span class="line"><span># 警告用户不要随意修改数据库</span></span>
<span class="line"><span>comment = Do not arbitrarily modify the database file</span></span>
<span class="line"><span># 指定路径</span></span>
<span class="line"><span>path = /mnt/samba_data</span></span>
<span class="line"><span># 关闭“所有人可见”</span></span>
<span class="line"><span>public = no</span></span>
<span class="line"><span># 允许写入操作</span></span>
<span class="line"><span>writable = yes</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>mkdir /mnt/samba_data</span></span>
<span class="line"><span>chmod -R 777 /mnt/samba_data</span></span>
<span class="line"><span>chcon -R -t samba_share_t /mnt/samba_data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>pdbedit -a -u root</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># 测试一下是否成功共享</span></span>
<span class="line"><span>smbclient -L //127.0.0.1 -U root</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>可选：添加家目录 SELinux 策略</p><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>setsebool -P samba_enable_home_dirs on</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>systemctl restart smb</span></span>
<span class="line"><span>systemctl enable smb</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="linux-客户端挂载" tabindex="-1"><a class="header-anchor" href="#linux-客户端挂载"><span><a href="#linux-%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%8C%82%E8%BD%BD"></a>Linux 客户端挂载</span></a></h4><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>vim ~/auth.smb</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>username=root</span></span>
<span class="line"><span>password=123</span></span>
<span class="line"><span>domain=MYGROUP</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>chmod -Rf 600 ~/auth.smb</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>mkdir /mnt/data</span></span>
<span class="line"><span>chmod 777 /mnt/data</span></span>
<span class="line"><span># //IP/[samba服务配置文件里的标识名，而不是实际路径]</span></span>
<span class="line"><span>sed -i &quot;$ a //192.168.1.70/samba_share /mnt/data cifs credentials=/root/auth.smb 0 0&quot; /etc/fstab</span></span>
<span class="line"><span>mount -a</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="debain-系配置" tabindex="-1"><a class="header-anchor" href="#debain-系配置"><span><a href="#debain-%E7%B3%BB%E9%85%8D%E7%BD%AE"></a>Debain 系配置</span></a></h2><ul><li>主配置文件：/etc/samba/smb.conf</li></ul><p>待补充</p>`,28)]))}const c=a(l,[["render",t]]),h=JSON.parse('{"path":"/notes/linux/%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/samba.html","title":"samba - 微软的网络文件系统","lang":"zh-CN","frontmatter":{"date":"2022-01-09T00:00:00.000Z","category":"应用服务","tag":["Linux","网络文件系统"],"description":"samba - 微软的网络文件系统 微软公司和英特尔公司共同制定了SMB（Server Messages Block，服务器消息块）协议，Samba服务程序现在已经成为在Linux系统与Windows系统之间共享文件的最佳选择。 安装与启用 yum、apt 包名：samba RHEL 系 systemctl 服务名：smb RHEL 系 客户端包名：s...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"samba - 微软的网络文件系统\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-01-09T00:00:00.000Z\\",\\"dateModified\\":\\"2025-01-02T07:54:44.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://xiangcheng.site/notes/linux/%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/samba.html"}],["meta",{"property":"og:site_name","content":"大橙的运维宝典"}],["meta",{"property":"og:title","content":"samba - 微软的网络文件系统"}],["meta",{"property":"og:description","content":"samba - 微软的网络文件系统 微软公司和英特尔公司共同制定了SMB（Server Messages Block，服务器消息块）协议，Samba服务程序现在已经成为在Linux系统与Windows系统之间共享文件的最佳选择。 安装与启用 yum、apt 包名：samba RHEL 系 systemctl 服务名：smb RHEL 系 客户端包名：s..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-01-02T07:54:44.000Z"}],["meta",{"property":"article:tag","content":"网络文件系统"}],["meta",{"property":"article:tag","content":"Linux"}],["meta",{"property":"article:published_time","content":"2022-01-09T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-01-02T07:54:44.000Z"}]]},"git":{"createdTime":1732214708000,"updatedTime":1735804484000,"contributors":[{"name":"daCheng","username":"daCheng","email":"xiangxiaoc@outlook.com","commits":2,"url":"https://github.com/daCheng"}]},"readingTime":{"minutes":2.57,"words":771},"filePathRelative":"notes/linux/应用服务/samba.md","excerpt":"\\n<p>微软公司和英特尔公司共同制定了SMB（Server Messages Block，服务器消息块）协议，Samba服务程序现在已经成为在Linux系统与Windows系统之间共享文件的最佳选择。</p>\\n<h3><a class=\\"header-anchor\\" href=\\"#安装与启用\\"><span></span></a><a href=\\"#%E5%AE%89%E8%A3%85%E4%B8%8E%E5%90%AF%E7%94%A8\\"></a>安装与启用</h3>\\n<ul>\\n<li>yum、apt 包名：samba</li>\\n<li>RHEL 系 systemctl 服务名：smb</li>\\n<li>RHEL 系 客户端包名：samba-client cifs-utils</li>\\n<li>Debain 系 systemctl 服务名：smbd</li>\\n<li>apt 客户端包名：smbclient cifs-utils</li>\\n</ul>","autoDesc":true}');export{c as comp,h as data};
