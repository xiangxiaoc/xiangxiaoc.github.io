import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,d as e,o as n}from"./app-C2Q3Ldgq.js";const t={};function l(p,i){return n(),a("div",null,i[0]||(i[0]=[e(`<h1 id="dump备份" tabindex="-1"><a class="header-anchor" href="#dump备份"><span>dump备份</span></a></h1><p>找更多信息走官方：<a href="https://github.com/elasticsearch-dump/elasticsearch-dump" target="_blank" rel="noopener noreferrer">官方github</a></p><h2 id="安装-npm-elasticdump-包" tabindex="-1"><a class="header-anchor" href="#安装-npm-elasticdump-包"><span>安装 npm elasticdump 包</span></a></h2><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">npm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> elasticdump</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -g</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="multielasticdump-多索引的-dump-和-load" tabindex="-1"><a class="header-anchor" href="#multielasticdump-多索引的-dump-和-load"><span>multielasticdump 多索引的 dump 和 load</span></a></h2><p>dump 整个集群，包括所有索引，所有类型的数据(包括额外三类数据：mapping setting template)</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 备份到本地</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> es_data</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">multielasticdump</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\ </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  --direction</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">dump</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  --match=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;^[^.].*$&#39;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  --ignoreType=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;analyzer&#39;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  --input=http://elasticsearch:9200</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  --output=es_data</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  --quiet</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  --limit=2000</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 恢复到集群</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">multielasticdump</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\ </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  --direction</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">load</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  --match=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;^[^.].*$&#39;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  --ignoreType=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;analyzer&#39;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  --input=es_data</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  --output=http://elasticsearch:9200</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  --quiet</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  --limit=2000</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>^[^.].*$</code> 这个正则是用来匹配所有索引，但排除以 . 开头的索引，这些是es内部的索引，不需要dump出来</p><h3 id="关于选项参数" tabindex="-1"><a class="header-anchor" href="#关于选项参数"><span>关于选项参数</span></a></h3><h4 id="includetype" tabindex="-1"><a class="header-anchor" href="#includetype"><span>includeType</span></a></h4><blockquote><p>Six options are supported - data,mapping,analyzer,alias,settings,template</p><p>NB: analyzer &amp; alias types are ignored by default</p></blockquote><p>官方说 analyzer 和 alias 类型默认就是忽略的，也就是 includeType 选项什么都不指定时，会备份 data, mapping, settings, template</p><p>但我觉得 alias 也需要，所以建议使用 ignoreType</p><h4 id="ignoretype" tabindex="-1"><a class="header-anchor" href="#ignoretype"><span>ignoreType</span></a></h4><p>多个需要忽略的格式如下：</p><p><code>--ignoreType=&#39;analyzer,alias&#39;</code></p><h4 id="quiet" tabindex="-1"><a class="header-anchor" href="#quiet"><span>quiet</span></a></h4><blockquote><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>--quiet</span></span>
<span class="line"><span>  Suppress all messages except for errors</span></span>
<span class="line"><span>  (default: false)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><p>加 --quiet 选项可以减少已备份对象数量和offset等进度信息的输出</p><h4 id="limit" tabindex="-1"><a class="header-anchor" href="#limit"><span>limit</span></a></h4><blockquote><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>--limit</span></span>
<span class="line"><span>  How many objects to move in batch per operation</span></span>
<span class="line"><span>  limit is approximate for file streams</span></span>
<span class="line"><span>  (default: 100)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><p>默认值 100 个对象一批，实测不是很占用 cpu 和 内存，可以适当调高点</p>`,22)]))}const r=s(t,[["render",l]]),c=JSON.parse('{"path":"/notes/database/elasticsearch/dump%E5%A4%87%E4%BB%BD.html","title":"dump备份","lang":"zh-CN","frontmatter":{"date":"2025-05-21T00:00:00.000Z","category":"elasticsearch","tag":["数据库"],"description":"dump备份 找更多信息走官方：官方github 安装 npm elasticdump 包 multielasticdump 多索引的 dump 和 load dump 整个集群，包括所有索引，所有类型的数据(包括额外三类数据：mapping setting template) ^[^.].*$ 这个正则是用来匹配所有索引，但排除以 . 开头的索引，这...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"dump备份\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-05-21T00:00:00.000Z\\",\\"dateModified\\":\\"2025-05-27T09:41:25.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://xiangcheng.site/notes/database/elasticsearch/dump%E5%A4%87%E4%BB%BD.html"}],["meta",{"property":"og:site_name","content":"大橙的运维宝典"}],["meta",{"property":"og:title","content":"dump备份"}],["meta",{"property":"og:description","content":"dump备份 找更多信息走官方：官方github 安装 npm elasticdump 包 multielasticdump 多索引的 dump 和 load dump 整个集群，包括所有索引，所有类型的数据(包括额外三类数据：mapping setting template) ^[^.].*$ 这个正则是用来匹配所有索引，但排除以 . 开头的索引，这..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-05-27T09:41:25.000Z"}],["meta",{"property":"article:tag","content":"数据库"}],["meta",{"property":"article:published_time","content":"2025-05-21T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-05-27T09:41:25.000Z"}]]},"git":{"createdTime":1748338885000,"updatedTime":1748338885000,"contributors":[{"name":"daCheng","username":"daCheng","email":"xiangxiaoc@outlook.com","commits":1,"url":"https://github.com/daCheng"}]},"readingTime":{"minutes":1.12,"words":335},"filePathRelative":"notes/database/elasticsearch/dump备份.md","excerpt":"\\n<p>找更多信息走官方：<a href=\\"https://github.com/elasticsearch-dump/elasticsearch-dump\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">官方github</a></p>\\n<h2>安装 npm elasticdump 包</h2>\\n<div class=\\"language-shell line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"shell\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">npm</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> install</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> elasticdump</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -g</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{r as comp,c as data};
